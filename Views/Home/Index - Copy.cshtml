@{
    ViewData["Title"] = "Exchange Rate Calculator";
}

<div class="container mt-5" id="app" v-cloak>
    <div class="text-center mb-4">
        <img src="~/images/access_logo.png" alt="Access LogSo" class="mb-3" style="max-height: 40px" />
        <h1>Exchange Rate Calculator</h1>
        <p>Flip currencies like a pro! See your Card’s rate in a tap</p>
    </div>

    <div class="row justify-content-center">
        <div class="col-md-5">
            <form id="fxCalculatorForm">
                <div class="mb-3">
                    <label for="amount" class="form-label">Amount</label>
                    <input type="number"
                           class="form-control"
                           id="amount"
                           v-model="amount"
                           placeholder="Enter amount"
                           step="0.01"
                           min="0"
                           required
                           :disabled="loading" />
                </div>

                <div class="row mb-3 align-items-end">
                    <div class="col">
                        <label for="fromCurrency" class="form-label">From Currency</label>
                        <select class="form-select" id="fromCurrency" v-model="fromCurrencyCode" required :disabled="loading">
                            <option value="">Select currency...</option>
                            <option v-for="currency in currencies" :key="currency.code" :value="currency.code">
                                {{ currency.shortName }} - {{ currency.name }}
                            </option>
                        </select>
                    </div>
                    <div class="col-auto d-flex align-items-end">
                        <button type="button"
                                class="btn btn-outline-secondary"
                                v-on:click.prevent="switchCurrencies"
                                :disabled="!fromCurrencyCode || !toCurrencyCode || loading"
                                style="margin-bottom:2px;">
                            &#8646;
                        </button>
                    </div>
                    <div class="col">
                        <label for="toCurrency" class="form-label">To Currency</label>
                        <select class="form-select" id="toCurrency" v-model="toCurrencyCode" required :disabled="loading">
                            <option value="">Select currency...</option>
                            <option v-for="currency in currencies" :key="currency.code" :value="currency.code">
                                {{ currency.shortName }} - {{ currency.name }}
                            </option>
                        </select>
                    </div>
                </div>

                <div class="d-grid gap-2" style="grid-template-columns: 1fr auto;">
                    <button type="button"
                            class="btn btn-primary"
                            v-on:click.prevent="convertFX"
                            :disabled="!isValidConversion() || loading">
                        <span v-if="loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        <span v-else>Calculate</span>
                    </button>
                    <button type="button"
                            class="btn btn-secondary btn-sm"
                            style="width: 90px;"
                            v-on:click.prevent="resetForm"
                            :disabled="loading">
                        Reset
                    </button>
                </div>
            </form>

            <div v-if="fxError" class="mt-3 text-center" style="color: #d32f2f; font-weight: bold;">
                {{ fxError }}
            </div>

            <div v-if="fxResult !== null && fromCurrency && toCurrency"
                 class="mt-4 p-3 pt-4 rounded text-center"
                 style="background-color: #f0f0f0;">
                <strong class="h5">{{ sourceAmount }} {{ sourceCurrencyName }} = {{ fxResult.destinationAmount }} {{ destinationCurrencyName }}</strong>
                <p>1 {{ sourceCurrencyName }} = {{ fxResult.conversionRate }} {{ destinationCurrencyName }}</p>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script src="~/js/index.js?v=1.0"></script>
}
